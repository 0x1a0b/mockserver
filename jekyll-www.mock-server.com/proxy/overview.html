---
title: Overview
layout: page
pageOrder: 1
section: 'Proxy'
subsection: true
---

<p>MockServer also provides an HTTP / HTTPS proxy that can be used to record requests / responses.</p>

<p>Once requests / responses have been recorded:</p>

<ul>
	<li>They can be queried pragmatically to confirm what requests have been sent and what responses have been received.
		<ul>
			<li>This supports test assertions that confirm what requests the system-under-test has been sending during a test.</li>
		</ul>
	</li>
	<li>They can be output in JSON format to log what request the system under has sent and what responses it received.
		<ul>
			<li>This is useful for analysing an existing system prior to writing automated tests.</li>
			<li>This is also useful to simplify the creation of test setup code as the JSON output is in MockServer expectation format.</li>
		</ul>
	</li>
	<li>They can be output in human readable Java code format that can be pasted directly into a test setup method.
		<ul>
			<li>This is useful to simplify the creation of expectations in test setup methods as the code can be easily pasted directly into a test setup method and then modified as appropriate for the needs of the test scenario.</li>
		</ul>
	</li>
</ul>

<p>For example to use the proxy to verify a request has been sent:</p>

<pre><code class="code"><span class="keyword">new</span> ProxyClient(<span class="string_literal">"localhost"</span>, <span class="numeric_literal">9999</span>)
        .verify(
                request()
                        .withMethod(<span class="string_literal">"POST"</span>)
                        .withPath(<span class="string_literal">"/login"</span>)
                        .withBody(<span class="string_literal">"{username: 'foo', password: 'bar'}"</span>),
                VerificationTimes.exactly(<span class="numeric_literal">1</span>)
        );</code></pre>

<p>For example to use the proxy to print recorded requests and response to the log as JSON:</p>

<pre><code class="code"><span class="keyword">new</span> ProxyClient(<span class="string_literal">"localhost"</span>, <span class="numeric_literal">9999</span>)
        .dumpToLogAsJSON(
                request()
                        .withPath(<span class="string_literal">"/login"</span>)
        );</code></pre>

<p>This would result in entries in the <strong>mockserver_request.log</strong> file of the following format:</p>

<pre><code class="code">2014-01-11 13:08:54,225 {
    <span class="string_literal">"httpRequest"</span>: {
        <span class="string_literal">"method"</span>: <span class="string_literal">"POST"</span>,
        <span class="string_literal">"path"</span>: <span class="string_literal">"/login"</span>,
        <span class="string_literal">"body"</span>: {
            <span class="string_literal">"type"</span>: <span class="string_literal">"STRING"</span>,
            <span class="string_literal">"value"</span>: <span class="string_literal">"{username: 'foo', password: 'bar'}"</span>,
        },
        <span class="string_literal">"cookies"</span>: [
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"sid"</span>,
                <span class="string_literal">"values"</span>: [ <span class="string_literal">"05F1A3D2F2143C49727"</span> ]
            }
        ],
        <span class="string_literal">"headers"</span>: [
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"Accept-Language"</span>,
                <span class="string_literal">"values"</span>: [ <span class="string_literal">"en-US,en;q=0.8,fa;q=0.6"</span> ]
            },
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"Cookie"</span>,
                <span class="string_literal">"values"</span>: [ <span class="string_literal">"sid=05F1A3D2F2143C49727"</span> ]
            },
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"Host"</span>,
                <span class="string_literal">"values"</span>: [ <span class="string_literal">"localhost:2021"</span> ]
            },
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"Content-Length"</span>,
                <span class="string_literal">"values"</span>: [ <span class="string_literal">"34"</span> ]
            },
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"Accept-Encoding"</span>,
                <span class="string_literal">"values"</span>: [ <span class="string_literal">"gzip,deflate,sdch"</span> ]
            },
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"User-Agent"</span>,
                <span class="string_literal">"values"</span>: [ <span class="string_literal">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36"</span> ]
            },
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"Accept"</span>,
                <span class="string_literal">"values"</span>: [ <span class="string_literal">"*/*"</span> ]
            },
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"Content-Type"</span>,
                <span class="string_literal">"values"</span>: [ <span class="string_literal">"text/plain"</span> ]
            }
        ]
    },
    <span class="string_literal">"httpResponse"</span>: {
        <span class="string_literal">"statusCode"</span>: <span class="numeric_literal">200</span>,
        <span class="string_literal">"body"</span>: <span class="string_literal">"{ message: 'success' }"</span>,
        <span class="string_literal">"headers"</span>: [
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"Content-Type"</span>,
                <span class="string_literal">"values"</span>: [ <span class="string_literal">"application/json; charset=utf-8"</span> ]
            },
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"Cache-Control"</span>,
                <span class="string_literal">"values"</span>: [ <span class="string_literal">"no-cache, no-store"</span> ]
            }
        ]
    },
    <span class="string_literal">"times"</span>: {
        <span class="string_literal">"remainingTimes"</span>: <span class="numeric_literal">1</span>,
        <span class="string_literal">"unlimited"</span>: <span class="keyword">false</span>
    }
}</code></pre>

<h2>Requirements</h2>

<ul>
	<li><strong>Java 6+</strong>&nbsp;&nbsp;&nbsp;to use the Netty version, the Maven Plugin and MockServer WAR and proxy WAR</li>
	<li><strong>Java 7+</strong>&nbsp;&nbsp;&nbsp;to use the Vert.X module or the Embedded Jetty version as both Jetty 9 and Vert.X in turn require Java 7 (<strong>Note:</strong> all features provided in the Embedded Jetty version are also available using the Netty version)</li>
</ul>
