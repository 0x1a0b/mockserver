---
title: Overview
layout: page
pageOrder: 1
section: 'Mock Server'
subsection: true
---

<h2>Getting Started</h2>

<p>To use MockServer:</p>

<ol>
	<li><a href="#starting-mockserver">Start MockServer</a></li>
	<li><a href="#create-expectations">Create Expectations</a></li>
	<li><a href="#verify-behaviour">Verify Behaviour</a></li>
	<li>Run Tests</li>
</ol>

<p>To mock an HTTP / HTTPS interaction an expectation is setup specifying how a request should be matched and what action MockServer should take with when the request has been matched.</p>

<p>When a request is matched there are three actions that can be defined as follows:</p>

<ul>
	<li><strong>respond</strong> - return a "mock" response</li>
	<li><strong>forward</strong> - forward the request</li>
	<li><strong>callback</strong> - execute a callback</li>
</ul>

<p>For example to create an expectation using <strong>Java</strong> then has a respond action:</p>

<pre><code class="code"><span class="keyword">new</span> MockServerClient(<span class="string_literal">"localhost"</span>, <span class="numeric_literal">9999</span>)
        .when(
                request()
                        .withMethod(<span class="string_literal">"POST"</span>)
                        .withPath(<span class="string_literal">"/login"</span>)
                        .withQueryStringParameters(
                                <span class="keyword">new</span> Parameter(<span class="string_literal">"returnUrl"</span>, <span class="string_literal">"/account"</span>)
                        )
                        .withCookies(
                                <span class="keyword">new</span> Cookie(<span class="string_literal">"sessionId"</span>, <span class="string_literal">"2By8LOhBmaW5nZXJwcmludCIlMDAzMW"</span>)
                        )
                        .withBody(<span class="string_literal">"{username: 'foo', password: 'bar'}"</span>),
                Times.exactly(<span class="numeric_literal">1</span>)
        )
        .respond(
                response()
                        .withStatusCode(<span class="numeric_literal">401</span>)
                        .withHeaders(
                                <span class="keyword">new</span> Header(<span class="string_literal">"Content-Type"</span>, <span class="string_literal">"application/json; charset=utf-8"</span>),
                                <span class="keyword">new</span> Header(<span class="string_literal">"Cache-Control"</span>, <span class="string_literal">"public, max-age=86400"</span>)
                        )
                        .withBody(<span class="string_literal">"{ message: 'incorrect username and password combination' }"</span>)
                        .withDelay(<span class="keyword">new</span> Delay(TimeUnit.<span class="constant">SECONDS</span>, <span class="numeric_literal">1</span>))
        );</code></pre>

<p style="margin-top: 2em;">Or to create an expectation using <strong>JavaScript</strong>:</p>

<pre><code class="code">mockServerClient(<span class="string_literal">"http://localhost:9999"</span>).mockAnyResponse({
    <span class="string_literal">"httpRequest"</span>: {
        <span class="string_literal">"method"</span>: <span class="string_literal">"POST"</span>,
        <span class="string_literal">"path"</span>: <span class="string_literal">"/login"</span>,
        <span class="string_literal">"queryStringParameters"</span>: [
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"returnUrl"</span>,
                <span class="string_literal">"values"</span>: [<span class="string_literal">"/account"</span>]
            }
        ],
        <span class="string_literal">"cookies"</span>: [
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"sessionId"</span>,
                <span class="string_literal">"values"</span>: [<span class="string_literal">"2By8LOhBmaW5nZXJwcmludCIlMDAzMW"</span>]
            }
        ],
        <span class="string_literal">"body"</span>: {
            <span class="string_literal">"type"</span>: <span class="string_literal">"JSON"</span>,
            <span class="string_literal">"value"</span>: JSON.stringify({ username: <span class="string_literal">"foo"</span>, password: <span class="string_literal">"bar"</span> })
        }
    },
    <span class="string_literal">"httpResponse"</span>: {
        <span class="string_literal">"statusCode"</span>: <span class="numeric_literal">401</span>,
        <span class="string_literal">"headers"</span>: [
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"Content-Type"</span>,
                <span class="string_literal">"values"</span>: [<span class="string_literal">"application/json; charset=utf-8"</span>]
            },
            {
                <span class="string_literal">"name"</span>: <span class="string_literal">"Cache-Control"</span>,
                <span class="string_literal">"values"</span>: [<span class="string_literal">"public, max-age=86400"</span>]
            }
        ],
        <span class="string_literal">"body"</span>: JSON.stringify({ message: <span class="string_literal">"incorrect username and password combination"</span> }),
        <span class="string_literal">"delay"</span>: {
            <span class="string_literal">"timeUnit"</span>: <span class="string_literal">"SECONDS"</span>,
            <span class="string_literal">"value"</span>: <span class="numeric_literal">1</span>
        }
    },
    <span class="string_literal">"times"</span>: {
        <span class="string_literal">"remainingTimes"</span>: <span class="numeric_literal">1</span>,
        <span class="string_literal">"unlimited"</span>: <span class="keyword">false</span>
    }
});
</code></pre>

<h3>Requests can be matched on:</h3>

<ul>
	<li><strong>path</strong> - regex or plain text</li>
	<li><strong>query string</strong> - regex or plain text</li>
	<li><strong>headers</strong> - regex or plain text</li>
	<li><strong>cookies</strong> - regex or plain text</li>
	<li><strong>body</strong> - XPath, json, regex, plain text (exact match), or body parameters</li>
</ul>

<p>The body can be matched using plain text, a json expression, an XPath expression or a regular expression, see <a href="http://saxon.sourceforge.net/saxon6.5.3/expressions.html">XPath Expression Syntax</a> for supported XPath syntax.</p>

<p>All other matching can be done using plain text or a regular expression, see <a href="http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html">Pattern (Java Platform SE 6)</a> for supported regular expression syntax.</p>

<p>For more details see the section below on <a href="#create-expectations">creating expectations</a>.</p>

<h3>Actions can be defined:</h3>

<p>When a request is matched there are three actions that can be defined as follows:</p>

<ul>
	<li><strong>respond</strong> - return a "mock" response</li>
	<li><strong>forward</strong> - forward the request</li>
	<li><strong>callback</strong> - execute a callback</li>
</ul>

<h4><em>Respond Actions</em></h4>

<p>A response action defines a mock response.  Each response can contain:</p>

<ul>
	<li><strong>status code</strong></li>
	<li><strong>body</strong></li>
	<li><strong>headers</strong></li>
	<li><strong>cookies</strong></li>
</ul>

<p>Responses can be further controlled using:</p>

<ul>
	<li>a delay before the response is sent</li>
	<li>the number of times the response is sent (including unlimited)</li>
</ul>

<p>For more details see the section below on <a href="#create-expectations">creating expectations</a>.</p>

<h4><em>Forward Actions</em></h4>

<p>A forward action defines how a request should be forwarded.  Each forward can contain:</p>

<ul>
	<li><strong>host</strong></li>
	<li><strong>port</strong></li>
	<li><strong>scheme</strong></li>
</ul>

<p>Only the host is mandatory as the port is default to 80 and the scheme is defaulted to HTTP.</p>

<p>For more details see the section below on <a href="#create-expectations">creating expectations</a>.</p>

<h4><em>Callback Actions</em></h4>

<p>A callback action defines a class that will be used to dynamically generate the response.  Each callback contains:</p>

<ul>
	<li><strong>callbackClass</strong></li>
</ul>

<p>The class must define a default constructor and implement <strong>org.mockserver.mock.action.ExpectationCallback</strong>.</p>

<p>For more details see the section below on <a href="#create-expectations">creating expectations</a>.</p>

<h2>Requirements</h2>

<ul>
	<li><strong>Java 6+</strong>&nbsp;&nbsp;&nbsp;to use the Netty version, the Maven Plugin and MockServer WAR and proxy WAR</li>
	<li><strong>Java 7+</strong>&nbsp;&nbsp;&nbsp;to use the Vert.X module or the Embedded Jetty version as both Jetty 9 and Vert.X in turn require Java 7 (<strong>Note:</strong> all features provided in the Embedded Jetty version are also available using the Netty version)</li>
</ul>

<h2>Versions</h2>

<p>MockServer is flexible and support numerous usage patterns.</p>

<p>The mock server can be run:</p>

<ul>
	<li>via the mockserver-maven-plugin, for example, as part of a build cycle</li>
	<li>programmatically via an API, for example, in an <span class="annotation">@Before</span> / <span class="annotation">@After</span> method</li>
	<li>from the command line as a stand-alone process, for example, as part of a deployment process to a test environment</li>
	<li>from a Grunt build using a Grunt plugin</li>
	<li>from an Node.js code using an npm plugin</li>
</ul>

<p>MockServer is available as:</p>

<ul>
	<li>a stand alone Netty web server that is fully self contained</li>
	<li>a deployable WAR that runs on any JEE web server</li>
	<li>a Vert.X module that runs on a Vert.X</li>
	<li>a Grunt plugin (that has the embedded Netty server bundle with it)</li>
	<li>an npm plugin (that has the embedded Netty server bundle with it)</li>
</ul>
